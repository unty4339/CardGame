# クラス説明

- Card
    - デッキ手札システムで定義済み

- Deck
    - デッキ手札システムで定義済み

- Hand
    - Monobehaviorを継承しない
    - 各プレイヤーが保持する手札について責任を持つ
    - Cardsを示すHashSet<Card>またはList<Card>プロパティを持つ。順序なしでカードのセットを保持する

- FieldZone
    - Monobehaviorを継承しない
    - ユニットとトーテムが配置されるフィールドゾーンについて責任を持つ
    - Unitsを示すList<Unit>プロパティを持つ。順序付きでユニットを保持する
    - Totemsを示すList<Totem>プロパティを持つ。順序付きでトーテムを保持する
    - ユニットトーテムシステムで定義するUnit、Totemを参照する

- PartnerZone
    - Monobehaviorを継承しない
    - パートナーを配置するゾーンについて責任を持つ
    - Partnerを示すPartnerプロパティを持つ。パートナーインスタンスを1つ保持する
    - パートナーシステムで定義するPartnerを参照する

- PlayerData
    - Monobehaviorを継承しない
    - プレイヤーごとの情報について責任を持つ
    - HPを示すintプロパティを持つ。0になったら負ける
    - MaxMPを示すintプロパティを持つ。毎ターン、MPは最大値になる
    - CurrentMPを示すintプロパティを持つ。カードのプレイコストとして支払う
    - Deckを示すDeckプロパティを持つ
    - Handを示すHandプロパティを持つ
    - FieldZoneを示すFieldZoneプロパティを持つ
    - PartnerZoneを示すPartnerZoneプロパティを持つ

- PlayerManager
    - Monobehaviorを継承する
    - シングルトンパターンを採用
    - プレイヤー情報の管理とゾーン操作について責任を持つ
    - PlayerDataインスタンスを複数保持する
    - DrawCard (int playerId): プレイヤーIDを受け取り、デッキの一番上からカードを手札に加える
    - GetCardActions (int playerId, Card card): プレイヤーIDとカードを受け取り、そのカードの行動一覧を返す
    - GetUnitActions (int playerId, Unit unit): プレイヤーIDとユニットを受け取り、そのユニットの行動一覧を返す
    - AddCardToHand (int playerId, Card card): プレイヤーIDとカードを受け取り、効果で手札に新たなカードを加える

# 処理シーケンス

## デッキ構築の処理シーケンス

1. 初期化リクエスト（ゲームフロー管理 → DeckBuilder）
    - プレイヤーIDとDeckRecipeが渡される
    - DeckBuilder.BuildDeck(recipe)が呼ばれる

2. デッキの受け渡し（DeckBuilder → PlayerManager）
    - 構築されたDeckをPlayerManagerに渡す
    - PlayerManagerは該当プレイヤーのPlayerData.Deckに設定する

## ドローの処理シーケンス

1. ドローリクエスト（ゲームフロー管理 → PlayerManager）
    - プレイヤーIDが渡される
    - DrawCard(playerId)が呼ばれる

2. デッキの確認（PlayerManager）
    - 該当プレイヤーのDeckにカードが存在するか確認する
    - 存在しない場合、敗北フラグを立てて処理を終了する

3. カードの移動（PlayerManager）
    - Deckの先頭のCardを取得する
    - DeckからそのCardを削除する
    - HandにそのCardを追加する

## マリガンの処理シーケンス

1. マリガン選択（ゲームフロー管理）
    - プレイヤーが戻すカードを選択する

2. カードの返却（PlayerManager）
    - 選択されたCardをHandから削除する
    - それらのCardをDeckに戻す

3. シャッフル（PlayerManager）
    - Deckの順序をランダムに並べ替える

4. 引き直し（PlayerManager）
    - 返却した枚数だけDrawCardを実行する

## MP回復の処理シーケンス

1. ターン開始時（ゲームフロー管理 → PlayerManager）
    - ターンプレイヤーIDが渡される

2. 最大MPの増加（PlayerManager）
    - 該当プレイヤーのMaxMPを+1する

3. 現在MPの回復（PlayerManager）
    - 該当プレイヤーのCurrentMPをMaxMPと同じ値にする
