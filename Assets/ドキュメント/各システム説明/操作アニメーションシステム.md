# クラス説明

- ActionQueue
    - Monobehaviorを継承しない
    - 行動のキューについて責任を持つ
    - プレイヤーまたはAIの操作をFIFOで保持する
    - Enqueue (GameAction action): 行動を受け取り、キューに追加する
    - Dequeue (): キューから先頭の行動を取り出して返す
    - IsEmpty (): キューが空かどうかを返す

- GameAction
    - ステート管理AIシステムで定義済み

- ActionQueueManager
    - Monobehaviorを継承する
    - シングルトンパターンを採用
    - 行動キューの受け取りと消化、アニメーション再生について責任を持つ
    - ActionQueueインスタンスを1つ保持する
    - AddAction (GameAction action): 行動を受け取り、ActionQueueに追加する
    - ProcessNextAction (): キューから1つ行動を取り出し、アニメーションを流しつつオブジェクトを操作する

# 処理シーケンス

## 行動の追加の処理シーケンス

1. プレイヤー操作時（ゲームフロー管理 → ActionQueueManager）
    - ユーザーが画面で有効な行動操作を行った
    - またはAIが行動を決定した
    - AddAction(action)が呼ばれる

2. キューの追加（ActionQueueManager）
    - 受け取ったGameActionをActionQueue.Enqueue()でキューに追加する

## 行動キューの消化の処理シーケンス

1. 更新ループ（ActionQueueManager）
    - 毎フレームまたは一定間隔でProcessNextAction()が呼ばれる
    - ActionQueueが空の場合、処理をスキップする

2. 行動の取得（ActionQueueManager）
    - ActionQueue.Dequeue()で先頭の行動を取り出す

3. 行動種別の判定（ActionQueueManager）
    - 行動がカードのプレイ、パートナーのプレイ、ユニットの攻撃のいずれかを判定する

4. アニメーションとオブジェクト操作（ActionQueueManager）
    - 該当するアニメーションを再生する
    - ゲームロジック（UnitManager、BattleManager、PartnerManagerなど）を呼び出してオブジェクトの状態を更新する
    - アニメーション完了を待つか、非同期で次の行動の処理に進む

5. 反復（ActionQueueManager）
    - キューが空になるまで手順1〜4を繰り返す
    - 1行動ずつ消化する場合は、アニメーション完了後に次のフレームで再度ProcessNextAction()が呼ばれる
