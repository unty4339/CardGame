# クラス説明

- Partner
    - Monobehaviorを継承しない
    - パートナーの性能データについて責任を持つ
    - カードとしての性能（プレイコスト、ユニット登場時のステータスなど）を保持する
    - パートナーゾーンに表側で置かれた状態と、ユニットとしてフィールドに登場した状態の両方に対応する

- Unit
    - ユニットトーテムシステムで定義済み

- PartnerZone
    - プレイヤー情報システムで定義済み

- PartnerManager
    - Monobehaviorを継承する
    - シングルトンパターンを採用
    - パートナーの配置とユニット登場・戻しについて責任を持つ
    - PlacePartner (int playerId, Partner partner): プレイヤーIDとパートナーを受け取り、パートナーゾーンに表側で配置する
    - SpawnPartnerAsUnit (int playerId): プレイヤーIDを受け取り、コストを支払ってパートナーをユニットとしてフィールドに登場させる
    - ReturnPartnerToZone (Unit partnerUnit, int ownerPlayerId): パートナーユニットとオーナーIDを受け取り、パートナーゾーンに戻す

# 処理シーケンス

## パートナーゾーンへの配置の処理シーケンス

1. ゲーム開始時（ゲームフロー管理 → PartnerManager）
    - 各プレイヤーに初期パートナーが割り当てられる
    - PlacePartner(playerId, partner)が呼ばれる

2. ゾーンの設定（PartnerManager）
    - 該当プレイヤーのPartnerZoneのPartnerプロパティに設定する
    - パートナーは表側で置かれた状態となる

## パートナーをユニットとして登場させる処理シーケンス

1. プレイリクエスト（ゲームフロー管理 → PartnerManager）
    - プレイヤーがコストを支払ってパートナーをプレイする
    - SpawnPartnerAsUnit(playerId)が呼ばれる

2. コストの確認（PartnerManager）
    - 該当プレイヤーのCurrentMPがパートナーのコスト以上であることを確認する
    - 不足している場合、処理を中止する

3. コストの支払い（PartnerManager → PlayerManager）
    - CurrentMPからパートナーのコストを減算する

4. ユニットの生成（PartnerManager）
    - Partnerの性能を元にUnitインスタンスを生成する
    - パートナーであることを示すフラグまたは参照を保持する

5. フィールドへの配置（PartnerManager）
    - 生成したUnitをFieldZoneに追加する
    - PartnerZoneのPartnerはそのまま保持する（ユニットとして登場中もゾーンに存在を示す）

## パートナーの破壊時ゾーン戻しの処理シーケンス

1. 破壊検知（戦闘システム → PartnerManager）
    - パートナーであるUnitが体力0以下で破壊された
    - ReturnPartnerToZone(partnerUnit, ownerPlayerId)が呼ばれる

2. フィールドからの除去（PartnerManager）
    - 該当UnitをFieldZoneから削除する

3. ゾーンへの戻し（PartnerManager）
    - PartnerZoneは既にPartnerを保持しているため、状態を「ユニット登場可能」に更新する
    - 再度コストを支払うことでユニットとして登場できるようにする
